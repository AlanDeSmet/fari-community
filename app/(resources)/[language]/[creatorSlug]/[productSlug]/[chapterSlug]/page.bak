import { DocParser } from "app/(domains)/documents/DocParser";
import dynamic from "next/dynamic";
import path from "path";

export default async function Page(props: {
  params: {
    language: string;
    type: string;
    authorSlug: string;
    productSlug: string;
    chapterSlug: string;
  };
}) {
  const directory = path.join(process.cwd(), "data", "documents");
  const filePath =
    props.params.language === "en"
      ? `/${props.params.authorSlug}/${props.params.productSlug}.md`
      : `/${props.params.authorSlug}/${props.params.productSlug}_${props.params.language}.md`;

  const fileContents = await dynamic(directory + filePath);

  const doc = new DocParser({
    currentChapterId: props.params.chapterSlug,
    markdown: fileContents,
  }).getDoc();

  return (
    <>
      <style dangerouslySetInnerHTML={{ __html: doc.style as string }} />
      <article
        dangerouslySetInnerHTML={{
          __html: doc.html,
        }}
      />
    </>
  );
}
